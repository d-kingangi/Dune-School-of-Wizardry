WITH
  volume AS (
    SELECT
      DATE_TRUNC('day', block_time) AS daytime,
      SUM(amount_usd) AS amount_usd
    FROM
      dex.trades
    WHERE
      blockchain = 'base'
      AND (
        token_bought_address = FROM_HEX('4ed4E862860beD51a9570b96d89aF5E1B0Efefed')
        OR token_sold_address = FROM_HEX('4ed4E862860beD51a9570b96d89aF5E1B0Efefed')
      )
    GROUP BY
      DATE_TRUNC('day', block_time)
  )
SELECT
  daytime,
  amount_usd,
  SUM(amount_usd) OVER (
    ORDER BY
      daytime
  ) AS total_volume
FROM
  volume
ORDER BY
  daytime DESC



--daytime
--amount_usd
--total_volume

2024-04-03 00:00
18310830.77445058
746151393.6869972
2024-04-02 00:00
58607748.83117525
727840562.9125466
2024-04-01 00:00
71596681.46950392
669232814.0813714
2024-03-31 00:00
159042012.73552558
597636132.6118675
2024-03-30 00:00
87931477.76230316
438594119.876342
2024-03-29 00:00
37591991.64476076
350662642.1140388
2024-03-28 00:00
35893701.68763827
313070650.46927804
2024-03-27 00:00
15227398.111028466
277176948.78163975
2024-03-26 00:00
19881117.67720352
261949550.67061126
2024-03-25 00:00
34551366.6729399
242068432.99340773
2024-03-24 00:00
9991107.87462301
207517066.32046783
2024-03-23 00:00
5668331.348785326
197525958.44584483
2024-03-22 00:00
8001632.859762334
191857627.0970595
2024-03-21 00:00
12318714.922008742
183855994.23729715
2024-03-20 00:00
19112016.60900688
171537279.3152884
2024-03-19 00:00
5292355.394881099
152425262.7062815
2024-03-18 00:00
3866339.379301312
147132907.3114004
2024-03-17 00:00
3397311.5278168023
143266567.9320991
2024-03-16 00:00
7229626.291188258
139869256.4042823
2024-03-15 00:00
7296600.109355538
132639630.11309403
2024-03-14 00:00
10467574.116401859
125343030.0037385
2024-03-13 00:00
486514.9984032615
114875455.88733663
2024-03-12 00:00
776240.9890023065
114388940.88893336
2024-03-11 00:00
958990.4629915142
113612699.89993106
2024-03-10 00:00
1240952.4370971548
112653709.43693954