-- day
-- daily_active_users

SELECT
  DATE_TRUNC('day', block_time) AS day,
  COUNT(DISTINCT user) AS daily_active_users
FROM (
  SELECT
    ELEMENT_AT(account_keys, 0 + 1) AS user,
    block_time
  FROM solana.transactions
  WHERE
    CONTAINS(account_keys, '6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P')
    AND success = TRUE
    AND block_time > CURRENT_TIMESTAMP - INTERVAL '60' day
)
GROUP BY
  1
ORDER BY
  day

-- day
-- daily_active_users
2024-03-07 00:00
383
2024-03-08 00:00
257
2024-03-09 00:00
362
2024-03-10 00:00
370
2024-03-11 00:00
1632
2024-03-12 00:00
3252
2024-03-13 00:00
4785
2024-03-14 00:00
5275
2024-03-15 00:00
5887
2024-03-16 00:00
4449
2024-03-17 00:00
4164
2024-03-18 00:00
3660
2024-03-19 00:00
3757
2024-03-20 00:00
3310
2024-03-21 00:00
4700
2024-03-22 00:00
6294
2024-03-23 00:00
6266
2024-03-24 00:00
7227
2024-03-25 00:00
8843
2024-03-26 00:00
9619
2024-03-27 00:00
10144
2024-03-28 00:00
11657
2024-03-29 00:00
12287
2024-03-30 00:00
13574
2024-03-31 00:00
14895