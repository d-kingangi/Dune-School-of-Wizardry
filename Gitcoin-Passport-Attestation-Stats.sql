-- Day
-- Recipients
-- Cumulative Recipients
-- Week
-- Weekly Recipients
-- Month
-- Monthly Recipients


WITH recipient_counts AS (
  SELECT
    DATE_TRUNC('day', evt_block_time) AS "Day",
    COUNT(DISTINCT recipient) AS "Recipients"
  FROM attestationstation_v1_optimism.EAS_evt_Attested
  WHERE
    attester = 0x843829986e895facd330486a61ebee9e1f1adb1a
  GROUP BY
    1
)
SELECT
  "Day",
  "Recipients",
  SUM("Recipients") OVER (ORDER BY "Day") AS "Cumulative Recipients",
  DATE_TRUNC('week', "Day") AS "Week",
  SUM("Recipients") OVER (ORDER BY DATE_TRUNC('week', "Day")) AS "Weekly Recipients",
  DATE_TRUNC('month', "Day") AS "Month",
  SUM("Recipients") OVER (ORDER BY DATE_TRUNC('month', "Day")) AS "Monthly Recipients"
FROM recipient_counts
ORDER BY
  "Day"


-- Day
-- Recipients
-- Cumulative Recipients
-- Week
-- Weekly Recipients
-- Month
-- Monthly Recipients

2023-08-21 00:00
1
1
2023-08-21 00:00
5
2023-08-01 00:00
3986
2023-08-23 00:00
2
3
2023-08-21 00:00
5
2023-08-01 00:00
3986
2023-08-24 00:00
2
5
2023-08-21 00:00
5
2023-08-01 00:00
3986
2023-08-30 00:00
2273
2278
2023-08-28 00:00
6473
2023-08-01 00:00
3986
2023-08-31 00:00
1708
3986
2023-08-28 00:00
6473
2023-08-01 00:00
3986
2023-09-01 00:00
965
4951
2023-08-28 00:00
6473
2023-09-01 00:00
10149
2023-09-02 00:00
903
5854
2023-08-28 00:00
6473
2023-09-01 00:00
10149
2023-09-03 00:00
619
6473
2023-08-28 00:00
6473
2023-09-01 00:00
10149
2023-09-04 00:00
573
7046
2023-09-04 00:00
8224
2023-09-01 00:00
10149
2023-09-05 00:00
366
7412
2023-09-04 00:00
8224
2023-09-01 00:00
10149
2023-09-06 00:00
296
7708
2023-09-04 00:00
8224
2023-09-01 00:00
10149
2023-09-07 00:00
153
7861
2023-09-04 00:00
8224
2023-09-01 00:00
10149
2023-09-08 00:00
124
7985
2023-09-04 00:00
8224
2023-09-01 00:00
10149
2023-09-09 00:00
104
8089
2023-09-04 00:00
8224
2023-09-01 00:00
10149
2023-09-10 00:00
135
8224
2023-09-04 00:00
8224
2023-09-01 00:00
10149
2023-09-11 00:00
90
8314
2023-09-11 00:00
8807
2023-09-01 00:00
10149
2023-09-12 00:00
100
8414
2023-09-11 00:00
8807
2023-09-01 00:00
10149
2023-09-13 00:00
77
8491
2023-09-11 00:00
8807
2023-09-01 00:00
10149
2023-09-14 00:00
84
8575
2023-09-11 00:00
8807
2023-09-01 00:00
10149
2023-09-15 00:00
95
8670
2023-09-11 00:00
8807
2023-09-01 00:00
10149
2023-09-16 00:00
56
8726
2023-09-11 00:00
8807
2023-09-01 00:00
10149
2023-09-17 00:00
81
8807
2023-09-11 00:00
8807
2023-09-01 00:00
10149
2023-09-18 00:00
65
8872
2023-09-18 00:00
9162
2023-09-01 00:00
10149
2023-09-19 00:00
56
8928
2023-09-18 00:00
9162
2023-09-01 00:00
10149
2023-09-20 00:00
77
9005
2023-09-18 00:00
9162
2023-09-01 00:00
10149