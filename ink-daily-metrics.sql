-- date
-- total_transactions
-- unique_senders
-- unique_receivers
-- avg_gas_used
-- total_gas_used


WITH daily_metrics AS (
  SELECT
    b.date,
    COUNT(*) AS total_transactions,
    COUNT(DISTINCT TRY_CAST(t."from" AS VARCHAR)) AS unique_senders,
    COUNT(DISTINCT TRY_CAST(t."to" AS VARCHAR)) AS unique_receivers,
    AVG(t.gas_used) AS avg_gas_used,
    SUM(t.gas_used) AS total_gas_used
  FROM ink.transactions AS t
  JOIN ink.blocks AS b
    ON t.block_number = b.number
  WHERE
    t.success = TRUE 
  GROUP BY
    b.date
  ORDER BY
    b.date DESC
)
SELECT
  date,
  total_transactions,
  unique_senders,
  unique_receivers,
  ROUND(avg_gas_used, 2) AS avg_gas_used,
  total_gas_used
FROM daily_metrics


date
total_transactions
unique_senders
unique_receivers
avg_gas_used
total_gas_used
2025-01-19 00:00
131959
8151
3528
81486.81
10752917487
2024-12-15 00:00
86508
8
6
45102.25
3901705343
2025-01-26 00:00
218977
69441
5957
96586.89
21150307772
2025-02-22 00:00
234915
76627
3534
252835.79
59394918773
2024-12-27 00:00
109257
4140
4474
60085.68
6564780732
2024-12-31 00:00
119414
7288
5453
62095.69
7415095099
2024-12-24 00:00
114242
4898
6669
62186.48
7104307707
2025-01-11 00:00
119663
6294
2929
63167.84
7558853731
2024-12-13 00:00
86634
23
43
45979.78
3983412295
2025-02-07 00:00
202975
75672
3136
61545.09
12492114053
2025-02-21 00:00
205749
46650
3150
380679.25
78324375906
2025-01-30 00:00
250565
84437
5298
81860.61
20511404950
2025-01-03 00:00
109596
5031
2503
60055.54
6581846956
2025-02-10 00:00
232829
96332
4050
61675.15
14359762956
2024-12-30 00:00
114326
5658
4684
61666.02
7050029307
2024-12-12 00:00
86686
18
25
46812.32
4057972553
2024-12-16 00:00
87082
27
79
47031.35
4095583848
2025-01-23 00:00
142697
19297
6294
71001.69
10131728678
2025-01-22 00:00
112396
5484
2051
67579.77
7595695720
2025-01-29 00:00
232788
79387
4778
88121.87
20513714565
2025-02-23 00:00
169768
30995
4002
490217.37
83223223314
2025-02-12 00:00
214990
69165
3773
68416.47
14708856208
2025-01-09 00:00
115715
5512
2477
62024.38
7177150724
2025-02-01 00:00
219609
65292
3794
80616.11
17704023490
2025-01-07 00:00
144188
11822
5296
73660.01
10620890233